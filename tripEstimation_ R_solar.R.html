<!DOCTYPE html>
<!-- saved from url=(0051)https://rdrr.io/rforge/tripEstimation/src/R/solar.R -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <meta property="og:title" content="tripEstimation: R/solar.R">
    

    <link rel="icon" href="https://rdrr.io/favicon.ico">
    
    <link rel="canonical" href="https://rdrr.io/rforge/tripEstimation/src/R/solar.R">
    

    <link rel="stylesheet" href="./tripEstimation_ R_solar.R_files/semantic.min.css">

    <link rel="search" type="application/opensearchdescription+xml" title="R Documentation" href="https://rdrr.io/opensearch.xml">

    <title>tripEstimation: R/solar.R</title>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!-- <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script> -->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style>
      .top-spacer {
        height: 50.25px;
      }

      .toppad {
        margin-top: 24px !important;
      }

      .headertoppad {
        margin-top: 0.5em !important;
      }

      .darkblue {
        background-color: #283947 !important;
      }

      .highlight {
        margin: 1em;
        background-color: #f7f7f9;
        border: 1px solid #e1e1e8;
        border-radius: 4px;
      }

      .fullwidth {
        width: 100%;
      }

      .pre-error {
        background-color: #FFF6F6;
        box-shadow: 0 0 0 1px #E0B4B4 inset, 0 0 0 0 transparent;
        padding: 1em;
      }

      .pre-warning {
        background-color: #FFFAF3;
        box-shadow: 0 0 0 1px #C9BA9B inset, 0 0 0 0 transparent;
        padding: 1em;
      }

      .pre-success {
        background-color: #FCFFF5;
        box-shadow: 0 0 0 1px #A3C293 inset, 0 0 0 0 transparent;
        padding: 1em;
      }

      .bc-row {
        padding: 0.5em 1em;
        background-color: #F3F4F5;
        border-bottom: 1px solid #D4D4D5;
        margin-bottom: 1em;
      }

      .bg-grey {
        background-color: #f3f4f5 !important;
      }

      .fakelink {
        color: #4183C4 !important;
      }

      .search-highlight {
        background-color: #ffff00;
      }

      pre {
        padding-left: 1em;
        padding-right: 1em;
        font-size: 90%;
        font-family: Consolas,Monaco,'Andale Mono',monospace;
      }

      code {
        padding: 2px 4px;
        font-size: 90%;
        color: #c7254e;
        background-color: #f9f2f4;
        border-radius: 4px;
        font-family: Consolas,Monaco,'Andale Mono',monospace;
      }

      blockquote {
        padding: 0 1em;
        color: #777;
        border-left: 0.25em solid #ddd;
      }

      @media (max-width: 767px) {
        .only-desktop {
          display:none !important;
        }
      }

      @media (min-width: 768px) {
        .only-mobile {
          display:none !important;
        }
      }

      @media (min-width: 768px) {
        .desktop-pad {
          padding-left: 210px;
        }
      }

      a.anchor {
        display: block;
        position: relative;
        top: -50.25px;
        visibility: hidden;
      }
    </style>

    <script id="twitter-wjs" src="./tripEstimation_ R_solar.R_files/widgets.js.download"></script><script src="./tripEstimation_ R_solar.R_files/ca-pub-6535703173049909.js.download"></script><script async="" src="./tripEstimation_ R_solar.R_files/analytics.js.download"></script><script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-462338-14', 'auto');
      ga('send', 'pageview');

      // https://support.google.com/analytics/answer/1136920?hl=en
      var trackOutboundLink = function(url) {
        ga('send', 'event', 'outbound', 'click', url, {
           'transport': 'beacon',
           'hitCallback': function(){document.location = url;}
        });
      }

      var trackSocialLink = function(url, network) {
        ga('send', 'event', 'social', network, url, {
           'transport': 'beacon'
        });
      }
    </script>

    <!-- Hotjar Tracking Code for rdrr.io -->
    <script>
      (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:404313,hjsv:5};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
      })(window,document,'//static.hotjar.com/c/hotjar-','.js?sv=');
    </script><script async="" src="./tripEstimation_ R_solar.R_files/hotjar-404313.js.download"></script>

    
  <style>
    .hll { background-color: #ffffcc }
.pyg-c { color: #408080; font-style: italic } /* Comment */
.pyg-err { border: 1px solid #FF0000 } /* Error */
.pyg-k { color: #008000; font-weight: bold } /* Keyword */
.pyg-o { color: #666666 } /* Operator */
.pyg-ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.pyg-cm { color: #408080; font-style: italic } /* Comment.Multiline */
.pyg-cp { color: #BC7A00 } /* Comment.Preproc */
.pyg-cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.pyg-c1 { color: #408080; font-style: italic } /* Comment.Single */
.pyg-cs { color: #408080; font-style: italic } /* Comment.Special */
.pyg-gd { color: #A00000 } /* Generic.Deleted */
.pyg-ge { font-style: italic } /* Generic.Emph */
.pyg-gr { color: #FF0000 } /* Generic.Error */
.pyg-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.pyg-gi { color: #00A000 } /* Generic.Inserted */
.pyg-go { color: #888888 } /* Generic.Output */
.pyg-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.pyg-gs { font-weight: bold } /* Generic.Strong */
.pyg-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.pyg-gt { color: #0044DD } /* Generic.Traceback */
.pyg-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.pyg-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.pyg-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.pyg-kp { color: #008000 } /* Keyword.Pseudo */
.pyg-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.pyg-kt { color: #B00040 } /* Keyword.Type */
.pyg-m { color: #666666 } /* Literal.Number */
.pyg-s { color: #BA2121 } /* Literal.String */
.pyg-na { color: #7D9029 } /* Name.Attribute */
.pyg-nb { color: #008000 } /* Name.Builtin */
.pyg-nc { color: #0000FF; font-weight: bold } /* Name.Class */
.pyg-no { color: #880000 } /* Name.Constant */
.pyg-nd { color: #AA22FF } /* Name.Decorator */
.pyg-ni { color: #999999; font-weight: bold } /* Name.Entity */
.pyg-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.pyg-nf { color: #0000FF } /* Name.Function */
.pyg-nl { color: #A0A000 } /* Name.Label */
.pyg-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.pyg-nt { color: #008000; font-weight: bold } /* Name.Tag */
.pyg-nv { color: #19177C } /* Name.Variable */
.pyg-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.pyg-w { color: #bbbbbb } /* Text.Whitespace */
.pyg-mb { color: #666666 } /* Literal.Number.Bin */
.pyg-mf { color: #666666 } /* Literal.Number.Float */
.pyg-mh { color: #666666 } /* Literal.Number.Hex */
.pyg-mi { color: #666666 } /* Literal.Number.Integer */
.pyg-mo { color: #666666 } /* Literal.Number.Oct */
.pyg-sb { color: #BA2121 } /* Literal.String.Backtick */
.pyg-sc { color: #BA2121 } /* Literal.String.Char */
.pyg-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.pyg-s2 { color: #BA2121 } /* Literal.String.Double */
.pyg-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.pyg-sh { color: #BA2121 } /* Literal.String.Heredoc */
.pyg-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.pyg-sx { color: #008000 } /* Literal.String.Other */
.pyg-sr { color: #BB6688 } /* Literal.String.Regex */
.pyg-s1 { color: #BA2121 } /* Literal.String.Single */
.pyg-ss { color: #19177C } /* Literal.String.Symbol */
.pyg-bp { color: #008000 } /* Name.Builtin.Pseudo */
.pyg-vc { color: #19177C } /* Name.Variable.Class */
.pyg-vg { color: #19177C } /* Name.Variable.Global */
.pyg-vi { color: #19177C } /* Name.Variable.Instance */
.pyg-il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <script async="" src="./tripEstimation_ R_solar.R_files/modules-0d3a52598263dc84678a59c7a2757b7c.js.download"></script><style type="text/css">iframe#_hjRemoteVarsFrame {display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;}</style><script type="text/javascript" charset="utf-8" async="" src="./tripEstimation_ R_solar.R_files/button.5b89bce04f133ec533459161985cf461.js.download"></script></head>

  <body>
    <div id="wrapper" style="min-height: 100%; position: relative; padding-bottom: 16px;">
      <div class="ui darkblue top fixed inverted menu" role="navigation" itemscope="" itemtype="http://www.schema.org/SiteNavigationElement">
        <a class="ui header item" href="https://rdrr.io/">rdrr.io</a>
        <a class="ui item " href="https://rdrr.io/" itemprop="url"><span itemprop="name">Home</span></a>
        <a class="ui item " href="https://rdrr.io/r/" itemprop="url"><span itemprop="name">R Docs <div class="ui tiny red label">3.3.3</div></span></a>
        <a class="ui item " href="https://rdrr.io/all/" itemprop="url"><span itemprop="name">Packages</span></a>
        <a class="ui item " href="https://rdrr.io/snippets/" itemprop="url"><span itemprop="name">Snippets</span></a>
        <a class="nbreport ui item " href="https://rdrr.io/rforge/tripEstimation/src/R/solar.R#">R Notebooks</a>

        <div class="right menu">
          <form class="item" method="GET" action="https://rdrr.io/search">
            <!-- <div class='ui right action left icon input'> -->
            <div class="ui right action input">
              <!-- <i class='search icon'></i> -->
              <input type="text" placeholder="package title, doc text, source code..." size="32" name="q">
              <button type="submit" class="ui green button" onclick="ga(&#39;send&#39;, &#39;event&#39;, {eventCategory: &#39;search&#39;, eventAction: &#39;topbar&#39;, transport: &#39;beacon&#39;}); ">Search</button>
            </div>
          </form>
        </div>
      </div>

      <div style="padding-bottom: 114px">
        <!-- empty div to pad content -->
        <div class="top-spacer">&nbsp;</div>

        
  <div class="ui fluid container bc-row">
    <div class="ui breadcrumb" itemscope="" itemtype="http://schema.org/BreadcrumbList">
      <a class="section" href="https://rdrr.io/">Home</a>

      <div class="divider"> / </div>

      <span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
        <a class="section" itemscope="" itemtype="http://schema.org/Thing" itemprop="item" href="https://rdrr.io/all/rforge/">
          <span itemprop="name">R-Forge</span>
        </a>
        <meta itemprop="position" content="1">
      </span>

      <div class="divider"> / </div>

      <span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
        <a class="section" itemscope="" itemtype="http://schema.org/Thing" itemprop="item" href="https://rdrr.io/rforge/tripEstimation">
          <span itemprop="name">tripEstimation</span>
        </a>
        <meta itemprop="position" content="2">
      </span>

      <div class="divider"> / </div>

      <span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem" class="active section">
        <a class="active section" itemscope="" itemtype="http://schema.org/Thing" itemprop="item" href="https://rdrr.io/rforge/tripEstimation/src/R/solar.R">
          <span itemprop="name">R/solar.R</span>
        </a>
        <meta itemprop="position" content="3">
      </span>
    </div>
  </div>

  <div class="ui stackable grid container">
    <div class="eleven wide column">
      <h1 class="ui block header">R/solar.R</h1>
      <table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="pyg-s">"solar"</span> <span class="pyg-o">&lt;-</span>
<span class="pyg-kr"><a href="https://rdrr.io/r/base/function.html">function</a></span><span class="pyg-p">(</span>day<span class="pyg-p">)</span> <span class="pyg-p">{</span>
  <span class="pyg-c1">## day - times as POSIXct</span>
  
  <span class="pyg-c1">## Extract components of time (GMT)</span>
  tm <span class="pyg-o">&lt;-</span> <span class="pyg-kp"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXlt</a></span><span class="pyg-p">(</span>day<span class="pyg-p">,</span>tz<span class="pyg-o">=</span><span class="pyg-s">"GMT"</span><span class="pyg-p">)</span>           
  hh <span class="pyg-o">&lt;-</span> tm<span class="pyg-o">$</span>hour
  mm <span class="pyg-o">&lt;-</span> tm<span class="pyg-o">$</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>
  ss <span class="pyg-o">&lt;-</span> tm<span class="pyg-o">$</span>sec

  <span class="pyg-c1">## Time as Julian day</span>
  jday <span class="pyg-o">&lt;-</span> <a href="https://rdrr.io/rforge/tripEstimation/man/julday.html">julday</a><span class="pyg-p">(</span>tm<span class="pyg-p">)</span><span class="pyg-o">+</span><span class="pyg-p">(</span>hh<span class="pyg-o">+</span><span class="pyg-p">(</span>mm<span class="pyg-o">+</span>ss<span class="pyg-o">/</span><span class="pyg-m">60</span><span class="pyg-p">)</span><span class="pyg-o">/</span><span class="pyg-m">60</span><span class="pyg-p">)</span><span class="pyg-o">/</span><span class="pyg-m">24</span>
  
  <span class="pyg-c1">## Time as Julian century</span>
  <a href="https://rdrr.io/r/base/t.html">t</a> <span class="pyg-o">&lt;-</span> <span class="pyg-p">(</span>jday<span class="pyg-m">-2451545</span><span class="pyg-p">)</span><span class="pyg-o">/</span><span class="pyg-m">36525</span>

  <span class="pyg-c1">## Geometric mean anomaly for the sun (degrees)</span>
  M <span class="pyg-o">&lt;-</span> <span class="pyg-m">357.52911</span><span class="pyg-o">+</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="pyg-o">*</span><span class="pyg-p">(</span><span class="pyg-m">35999.05029-0.0001537</span><span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="pyg-p">)</span>

  <span class="pyg-c1">## Equation of centre for the sun (degrees)</span>
  eqcent <span class="pyg-o">&lt;-</span> <span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="pyg-p">(</span><span class="pyg-kc"><a href="https://rdrr.io/r/base/Constants.html">pi</a></span><span class="pyg-o">/</span><span class="pyg-m">180</span><span class="pyg-o">*</span>M<span class="pyg-p">)</span><span class="pyg-o">*</span><span class="pyg-p">(</span><span class="pyg-m">1.914602</span><span class="pyg-o">-</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="pyg-o">*</span><span class="pyg-p">(</span><span class="pyg-m">0.004817+0.000014</span><span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="pyg-p">))</span><span class="pyg-o">+</span>
    <span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="pyg-p">(</span><span class="pyg-kc"><a href="https://rdrr.io/r/base/Constants.html">pi</a></span><span class="pyg-o">/</span><span class="pyg-m">180</span><span class="pyg-o">*</span><span class="pyg-m">2</span><span class="pyg-o">*</span>M<span class="pyg-p">)</span><span class="pyg-o">*</span><span class="pyg-p">(</span><span class="pyg-m">0.019993-0.000101</span><span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="pyg-p">)</span><span class="pyg-o">+</span>
      <span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="pyg-p">(</span><span class="pyg-kc"><a href="https://rdrr.io/r/base/Constants.html">pi</a></span><span class="pyg-o">/</span><span class="pyg-m">180</span><span class="pyg-o">*</span><span class="pyg-m">3</span><span class="pyg-o">*</span>M<span class="pyg-p">)</span><span class="pyg-o">*</span><span class="pyg-m">0.000289</span>
    
  <span class="pyg-c1">## The geometric mean sun longitude (degrees)</span>
  L0 <span class="pyg-o">&lt;-</span> <span class="pyg-m">280.46646</span><span class="pyg-o">+</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="pyg-o">*</span><span class="pyg-p">(</span><span class="pyg-m">36000.76983+0.0003032</span><span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="pyg-p">)</span>
  <span class="pyg-c1">## Limit to [0,360)</span>
  L0 <span class="pyg-o">&lt;-</span> L0<span class="pyg-o">%%</span><span class="pyg-m">360</span> 

  <span class="pyg-c1">## The true longitude of the sun (degrees)</span>
  lambda0 <span class="pyg-o">&lt;-</span> L0 <span class="pyg-o">+</span> eqcent
  
  <span class="pyg-c1">## The apparent longitude of the sun (degrees)</span>
  omega <span class="pyg-o">&lt;-</span> <span class="pyg-m">125.04-1934.136</span><span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/t.html">t</a></span>
  lambda <span class="pyg-o">&lt;-</span> lambda0<span class="pyg-m">-0.00569-0.00478</span><span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="pyg-p">(</span><span class="pyg-kc"><a href="https://rdrr.io/r/base/Constants.html">pi</a></span><span class="pyg-o">/</span><span class="pyg-m">180</span><span class="pyg-o">*</span>omega<span class="pyg-p">)</span>
  

  <span class="pyg-c1">## The mean obliquity of the ecliptic (degrees)</span>
  seconds <span class="pyg-o">&lt;-</span> <span class="pyg-m">21.448</span><span class="pyg-o">-</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="pyg-o">*</span><span class="pyg-p">(</span><span class="pyg-m">46.815</span><span class="pyg-o">+</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="pyg-o">*</span><span class="pyg-p">(</span><span class="pyg-m">0.00059</span><span class="pyg-o">-</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="pyg-o">*</span><span class="pyg-p">(</span><span class="pyg-m">0.001813</span><span class="pyg-p">)))</span>
  obliq0 <span class="pyg-o">&lt;-</span> <span class="pyg-m">23</span><span class="pyg-o">+</span><span class="pyg-p">(</span><span class="pyg-m">26</span><span class="pyg-o">+</span><span class="pyg-p">(</span>seconds<span class="pyg-o">/</span><span class="pyg-m">60</span><span class="pyg-p">))</span><span class="pyg-o">/</span><span class="pyg-m">60</span> 

  <span class="pyg-c1">## The corrected obliquity of the ecliptic (degrees)</span>
  omega <span class="pyg-o">&lt;-</span> <span class="pyg-m">125.04-1934.136</span><span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/t.html">t</a></span>
  obliq <span class="pyg-o">&lt;-</span> obliq0 <span class="pyg-o">+</span> <span class="pyg-m">0.00256</span><span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="pyg-p">(</span><span class="pyg-kc"><a href="https://rdrr.io/r/base/Constants.html">pi</a></span><span class="pyg-o">/</span><span class="pyg-m">180</span><span class="pyg-o">*</span>omega<span class="pyg-p">)</span>

  <span class="pyg-c1">## The eccentricity of earth's orbit</span>
  e <span class="pyg-o">&lt;-</span> <span class="pyg-m">0.016708634</span><span class="pyg-o">-</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="pyg-o">*</span><span class="pyg-p">(</span><span class="pyg-m">0.000042037+0.0000001267</span><span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="pyg-p">)</span>
  
  <span class="pyg-c1">## The equation of time (minutes of time)</span>
  y <span class="pyg-o">&lt;-</span> <span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="pyg-p">(</span><span class="pyg-kc"><a href="https://rdrr.io/r/base/Constants.html">pi</a></span><span class="pyg-o">/</span><span class="pyg-m">180</span><span class="pyg-o">*</span>obliq<span class="pyg-o">/</span><span class="pyg-m">2</span><span class="pyg-p">)</span><span class="pyg-o">^</span><span class="pyg-m">2</span>
  eqtime <span class="pyg-o">&lt;-</span> <span class="pyg-m">180</span><span class="pyg-o">/</span><span class="pyg-kc"><a href="https://rdrr.io/r/base/Constants.html">pi</a></span><span class="pyg-o">*</span><span class="pyg-m">4</span><span class="pyg-o">*</span><span class="pyg-p">(</span>y<span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="pyg-p">(</span><span class="pyg-kc"><a href="https://rdrr.io/r/base/Constants.html">pi</a></span><span class="pyg-o">/</span><span class="pyg-m">180</span><span class="pyg-o">*</span><span class="pyg-m">2</span><span class="pyg-o">*</span>L0<span class="pyg-p">)</span> <span class="pyg-o">-</span>
                      <span class="pyg-m">2</span><span class="pyg-o">*</span>e<span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="pyg-p">(</span><span class="pyg-kc"><a href="https://rdrr.io/r/base/Constants.html">pi</a></span><span class="pyg-o">/</span><span class="pyg-m">180</span><span class="pyg-o">*</span>M<span class="pyg-p">)</span> <span class="pyg-o">+</span>
                      <span class="pyg-m">4</span><span class="pyg-o">*</span>e<span class="pyg-o">*</span>y<span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="pyg-p">(</span><span class="pyg-kc"><a href="https://rdrr.io/r/base/Constants.html">pi</a></span><span class="pyg-o">/</span><span class="pyg-m">180</span><span class="pyg-o">*</span>M<span class="pyg-p">)</span><span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="pyg-p">(</span><span class="pyg-kc"><a href="https://rdrr.io/r/base/Constants.html">pi</a></span><span class="pyg-o">/</span><span class="pyg-m">180</span><span class="pyg-o">*</span><span class="pyg-m">2</span><span class="pyg-o">*</span>L0<span class="pyg-p">)</span> <span class="pyg-o">-</span>
                      <span class="pyg-m">0.5</span><span class="pyg-o">*</span>y<span class="pyg-o">^</span><span class="pyg-m">2</span><span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="pyg-p">(</span><span class="pyg-kc"><a href="https://rdrr.io/r/base/Constants.html">pi</a></span><span class="pyg-o">/</span><span class="pyg-m">180</span><span class="pyg-o">*</span><span class="pyg-m">4</span><span class="pyg-o">*</span>L0<span class="pyg-p">)</span> <span class="pyg-o">-</span>
                      <span class="pyg-m">1.25</span><span class="pyg-o">*</span>e<span class="pyg-o">^</span><span class="pyg-m">2</span><span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="pyg-p">(</span><span class="pyg-kc"><a href="https://rdrr.io/r/base/Constants.html">pi</a></span><span class="pyg-o">/</span><span class="pyg-m">180</span><span class="pyg-o">*</span><span class="pyg-m">2</span><span class="pyg-o">*</span>M<span class="pyg-p">))</span>

  <span class="pyg-c1">## The sun's declination (radians)</span>
  solarDec <span class="pyg-o">&lt;-</span> <span class="pyg-kp">asin</span><span class="pyg-p">(</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="pyg-p">(</span><span class="pyg-kc"><a href="https://rdrr.io/r/base/Constants.html">pi</a></span><span class="pyg-o">/</span><span class="pyg-m">180</span><span class="pyg-o">*</span>obliq<span class="pyg-p">)</span><span class="pyg-o">*</span><span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="pyg-p">(</span><span class="pyg-kc"><a href="https://rdrr.io/r/base/Constants.html">pi</a></span><span class="pyg-o">/</span><span class="pyg-m">180</span><span class="pyg-o">*</span>lambda<span class="pyg-p">))</span>
  sinSolarDec <span class="pyg-o">&lt;-</span> <span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="pyg-p">(</span>solarDec<span class="pyg-p">)</span>
  cosSolarDec <span class="pyg-o">&lt;-</span> <span class="pyg-kp"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="pyg-p">(</span>solarDec<span class="pyg-p">)</span>

  <span class="pyg-c1">## ALT</span>
  <span class="pyg-c1">## sinSolarDec &lt;- sin(pi/180*obliq)*sin(pi/180*lambda)</span>
  <span class="pyg-c1">## cosSolarDec &lt;- cos(asin(sinSolarDec))</span>

  <span class="pyg-c1">## Solar time unadjusted for longitude (degrees)</span>
  solarTime <span class="pyg-o">&lt;-</span> <span class="pyg-p">(</span>hh<span class="pyg-o">*</span><span class="pyg-m">60</span><span class="pyg-o">+</span>mm<span class="pyg-o">+</span>ss<span class="pyg-o">/</span><span class="pyg-m">60</span><span class="pyg-o">+</span>eqtime<span class="pyg-p">)</span><span class="pyg-o">/</span><span class="pyg-m">4</span>

  <span class="pyg-c1">## Return solar constants</span>
  <span class="pyg-kt"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="pyg-p">(</span>solarTime<span class="pyg-o">=</span>solarTime<span class="pyg-p">,</span>
       sinSolarDec<span class="pyg-o">=</span>sinSolarDec<span class="pyg-p">,</span>
       cosSolarDec<span class="pyg-o">=</span>cosSolarDec<span class="pyg-p">)</span>
<span class="pyg-p">}</span>
</pre></div>
</td></tr></tbody></table>
    </div>

    <div class="five wide column">
      <div class="ui vertical fluid menu">
        <div class="item only-desktop">
          <script async="" src="./tripEstimation_ R_solar.R_files/adsbygoogle.js.download"></script>
<!-- rpackages-default -->
<ins class="adsbygoogle" style="display: block; height: 600px;" data-ad-client="ca-pub-6535703173049909" data-ad-slot="9724778181" data-ad-format="auto" data-adsbygoogle-status="done"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:299px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:299px;background-color:transparent"><iframe width="299" height="600" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;" src="./tripEstimation_ R_solar.R_files/saved_resource.html"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

        </div>
        <div class="item only-mobile" style="height: 100px;">
          <script async="" src="./tripEstimation_ R_solar.R_files/adsbygoogle.js.download"></script>
<!-- rdrr-mobile-responsive -->
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6535703173049909" data-ad-slot="4915028187" data-ad-format="auto" data-adsbygoogle-status="done"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

        </div>

        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/as.image.pimg.html">
            <strong>as.image.pimg</strong>: Convert to image list
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/astro.html">
            <strong>astro</strong>: Calculations for position of the sun and moon
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/behav.bin.html">
            <strong>behav.bin</strong>: Bin MCMC chains.
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/bits.html">
            <strong>bits</strong>: Set and get bits from binary masks.
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/chain.read.html">
            <strong>chain.read</strong>: Manage MCMC cache.
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/elevation.html">
            <strong>elevation</strong>: Calculate elevation of astronomical objects
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/get.mask.html">
            <strong>get.mask</strong>: Create, access and manipulate spatial masks
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/get.sst.html">
            <strong>get.sst</strong>: Read SST data from online service.
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/initialize.x.html">
            <strong>initialize.x</strong>: Diagnose and initialize light level estimation.
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/julday.html">
            <strong>julday</strong>: Julian day and Julian century calculations from date-time...
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/metropolis.html">
            <strong>metropolis</strong>: Metropolis-Hastings sampler for location estimation for...
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/mkCalibration.html">
            <strong>mkCalibration</strong>: Create calibration of solar elevation to measured light...
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/mkLookup.html">
            <strong>mkLookup</strong>: Create a lookup function to query locations against spatial...
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/norm.proposal.html">
            <strong>norm.proposal</strong>: Manage proposal functions tune variance for metropolis...
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/old.metropolis.html">
            <strong>old.metropolis</strong>: Older versions of solar location estimation
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/pick.html">
            <strong>pick</strong>: Choose twilight segments interactively from light data.
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/pimg.list.html">
            <strong>pimg.list</strong>: Create a collection of probability images, for MCMC binning.
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/satellite.model.html">
            <strong>satellite.model</strong>: Function to create a satellite model object for metropolis...
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/solar.html">
            <strong>solar</strong>: Calculate solar postion parameters
          </a>
        
          <a class=" item" href="https://rdrr.io/rforge/tripEstimation/man/solar.model.html">
            <strong>solar.model</strong>: Function to create a solar model object for metropolis...
          </a>
        
      </div>
    </div>
  </div>


        

        <script src="./tripEstimation_ R_solar.R_files/jquery-3.1.1.min.js.download" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
        <!-- Fall back to a local copy of jQuery if the CDN fails -->
        <script>
          window.jQuery || document.write('<script src="/static/jquery-3.1.1.min.js"><\/script>');
        </script>

        <script src="./tripEstimation_ R_solar.R_files/semantic.min.js.download"></script>

        
        

        <script>
          var nb_report = function (action) {
            ga('send', 'event', {
              eventCategory: 'notebook',
              eventAction: 'headerbutton',
              transport: 'beacon'
            });
          };

          $(document).ready(function () {
            $('.nbreport').click(function (event) {
              nb_report();
            });

            $('.leftslide').popup({
              on: 'click',
              inline: true,
              preserve: true,
              lastResort: true,
              hoverable: true,
              position: 'right center',
              delay: {
                show: 300,
                hide: 800
              }
            });
          });
        </script>

        <link rel="stylesheet" href="./tripEstimation_ R_solar.R_files/css">
        <link rel="stylesheet" href="./tripEstimation_ R_solar.R_files/css(1)">
        <!-- <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5858cee2356cd0e3"></script>  -->
      </div>

      <div class="ui inverted darkblue toppad segment" style="position: absolute; bottom: 0; height: 114px; width: 100%; z-index: 1000;">
        <div class="ui center aligned container">
          <p>Questions? Problems? Suggestions? <iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" class="twitter-mention-button twitter-mention-button-rendered twitter-tweet-button" style="position: static; visibility: visible; width: 121px; height: 20px;" title="Twitter Tweet Button" src="./tripEstimation_ R_solar.R_files/tweet_button.a0ec3119d8db2bc5422f2144c89ad7a9.en.html" data-screen-name="rdrrHQ"></iframe><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script> or email at <a href="mailto:ian@mutexlabs.com">ian@mutexlabs.com</a>. </p>

          <p>Please suggest features or report bugs with the <a href="https://github.com/rdrr-io/rdrr-issues/issues" onclick="trackOutboundLink(&#39;https://github.com/rdrr-io/rdrr-issues/issues&#39;); return false;">GitHub issue tracker</a>.</p>

          <p>All documentation is copyright its authors; we didn't write any of that.</p>
        </div>
      </div>
    </div>
  

<iframe name="_hjRemoteVarsFrame" title="_hjRemoteVarsFrame" id="_hjRemoteVarsFrame" src="./tripEstimation_ R_solar.R_files/rcj-99d43ead6bdf30da8ed5ffcb4f17100c.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe><div id="ads"></div><iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;" title="Twitter analytics iframe" src="./tripEstimation_ R_solar.R_files/saved_resource(1).html"></iframe></body></html>