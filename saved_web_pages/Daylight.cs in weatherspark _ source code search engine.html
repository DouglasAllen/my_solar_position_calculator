<!DOCTYPE html>
<!-- saved from url=(0048)https://searchcode.com/codesearch/view/28602337/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Daylight.cs in weatherspark located at /WeatherSpark.Data">
  <link rel="shortcut icon" href="https://searchcode.com/static/favicon.ico" type="image/x-icon">
<title>Daylight.cs in weatherspark | source code search engine</title>
<link href="./Daylight.cs in weatherspark _ source code search engine_files/bootstrap.min.css" rel="stylesheet">
<link href="./Daylight.cs in weatherspark _ source code search engine_files/style.css" rel="stylesheet">
<link href="./Daylight.cs in weatherspark _ source code search engine_files/jquery.nouislider.css" rel="stylesheet">
<link rel="search" type="application/opensearchdescription+xml" title="searchcode" href="https://addons.mozilla.org/firefox/downloads/latest/570226/addon-570226-latest.xml">
<script async="" src="./Daylight.cs in weatherspark _ source code search engine_files/analytics.js.download"><img src="./Daylight.cs in weatherspark _ source code search engine_files/saved_resource" width="1" height="1" style="display: none;"></script><script type="text/javascript" async="" src="./Daylight.cs in weatherspark _ source code search engine_files/saved_resource(1)"></script><script src="./Daylight.cs in weatherspark _ source code search engine_files/jquery-1.11.1.min.js.download"></script>
<script id="_bsa_srv-CVAIVKJU_0" type="text/javascript" src="./Daylight.cs in weatherspark _ source code search engine_files/CVAIVKJU.json"></script><script id="_carbonads_projs" type="text/javascript" src="./Daylight.cs in weatherspark _ source code search engine_files/C6AILKT.json"></script></head>
<body>

  <nav class="navbar navbar-default" role="navigation">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="https://searchcode.com/">
          <img height="24px" src="./Daylight.cs in weatherspark _ source code search engine_files/searchcode_logo.png">
        </a>
      </div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav navbar-right">
          <li><a href="https://searchcode.com/about/">About</a></li>
          <li><a href="https://searchcode.com/api/">Developers</a></li>
          <li><a href="http://www.boyter.org/category/searchcode/">Updates</a></li>
          <li><a href="https://searchcode.com/product/">searchcode server</a></li>
        </ul>
      </div>
  </nav>


  <div class="container">
  

    
    <div class="search-options">
      <form action="https://searchcode.com/">
        <div class="form-inline">
          <div class="form-group">
            <input autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="true" size="50" placeholder="Search Expression" type="search" class="form-control" name="q" value="">
          </div><input type="submit" value="search" class="btn btn-success">
        </div>
      </form>
    </div>
    <div class="row">
      
      

      
      <script src="./Daylight.cs in weatherspark _ source code search engine_files/monetization.js.download" type="text/javascript"></script>
      <div id="ad_top"><div id="_default_"><span class="default-ad">ad</span><a href="https://srv.buysellads.com/ads/click/x/GTND423YF6BICKJYCT7LYKQWFTAIP2JYFTBD5Z3JCEADL2JWCVBIE23KC6BDE5QMCT7IKK3EHJNCLSIZ?segment=placement:demo;" target="_blank" rel="nofollow" class="_default_"><span class="default-image"><img src="./Daylight.cs in weatherspark _ source code search engine_files/37219"></span><span class="default-title">Create a new app, free.</span><span class="default-description">Have an app idea and want to see if it'll fly?</span></a><img src="./Daylight.cs in weatherspark _ source code search engine_files/img" style="display:none;" height="0" width="0"></div></div>
      <script>
      (function(){
        // format, zoneKey, segment:value, options
        _bsa.init('default', 'CVAIVKJU', 'placement:demo', {
          target: '#ad_top',
          align: 'horizontal',
          disable_css: 'true'
        });
      })();
      </script>

      <h4 class="codepath"><a href="https://hg.codeplex.com/weatherspark">
            
            <img src="./Daylight.cs in weatherspark _ source code search engine_files/microsoftaccount-24-black.png">
             weatherspark</a> /WeatherSpark.Data/Daylight.cs
      </h4>

    <table class="table">
        <tbody>
          <tr>
            <td colspan="5">
              <div>
                <script async="" type="text/javascript" src="./Daylight.cs in weatherspark _ source code search engine_files/carbon.js.download" id="_carbonads_js"></script><div id="carbonads"><span><span class="carbon-wrap"><a href="https://srv.carbonads.net/ads/click/x/GTND423YF6BITKJ7CT74YKQWFTAIP2JYFTSDEZ3JCEADL2JWCVAITK7KC6BDE5QMCT7IKK3EHJNCLSIZZRLCP7I35MNFV?segment=placement:searchcodecom;&amp;encredirect=https%3A%2F%2Fad.atdmt.com%2Fc%2Fgo%3Bp%3D11087208810591%3Ba%3D11087208790159%3Bev.a%3D1%3Bidfa%3D%3Bidfa_lat%3D%3Baaid%3D%3Baaid_lat%3D%3Bcache%3D" class="carbon-img" target="_blank"><img src="./Daylight.cs in weatherspark _ source code search engine_files/33430" alt="" border="0" height="100" width="130" style="max-width: 130px;"></a><a href="https://srv.carbonads.net/ads/click/x/GTND423YF6BITKJ7CT74YKQWFTAIP2JYFTSDEZ3JCEADL2JWCVAITK7KC6BDE5QMCT7IKK3EHJNCLSIZZRLCP7I35MNFV?segment=placement:searchcodecom;&amp;encredirect=https%3A%2F%2Fad.atdmt.com%2Fc%2Fgo%3Bp%3D11087208810591%3Ba%3D11087208790159%3Bev.a%3D1%3Bidfa%3D%3Bidfa_lat%3D%3Baaid%3D%3Baaid_lat%3D%3Bcache%3D" class="carbon-text" target="_blank">Have an app idea and want to see if it'll fly? Create a new app, free.</a></span><a href="http://carbonads.net/" class="carbon-poweredby" target="_blank">ads via Carbon</a><img src="./Daylight.cs in weatherspark _ source code search engine_files/img(1)" border="0" height="1" width="1" style="display: none;"><img src="./Daylight.cs in weatherspark _ source code search engine_files/skeleton.gif" border="0" height="1" width="1" style="display: none;"></span></div>
                <style>#carbonads{margin: 0 auto;padding: 1em;max-width: 26em !important;border: solid 2px #428bca;border-radius: 3px;font-size: .9em;font-family: Verdana, sans-serif;line-height: 1.5;} #carbonads * {display: block;overflow: hidden;} .carbon-img{float: left; margin-right: 1em !important; margin-bottom: .5em;} .carbon-text{float: left;max-width: 12em; text-align: left;} .carbon-poweredby{margin-top: -1em;text-align: right;font-size: .9em !important;}</style>
              </div>
            </td>
          </tr>
          <tr>
            <td><span class="glyphicon glyphicon-asterisk" aria-hidden="true"></span> Language</td>
            <td>C#</td>
            <td><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Lines</td>
            <td>112</td>
          </tr>
          <tr>
            <td><span class="glyphicon glyphicon-random" aria-hidden="true"></span> MD5 Hash</td>
            <td>92c78070280a04a8370b2c9d450cd4c1</td>
            
            <td><span class="glyphicon glyphicon-usd" aria-hidden="true"></span> Estimated Cost</td>
            <td>$1,930 <small><a href="https://searchcode.com/about/#estimatedcost">(why?)</a></small></td>
            
          </tr>
          <tr>
            <td><span class="glyphicon glyphicon-globe" aria-hidden="true"></span> Repository</td>
            <td>https://hg.codeplex.com/weatherspark</td>
            <td><a href="https://searchcode.com/codesearch/raw/28602337" rel="nofollow"><span class="glyphicon glyphicon-align-left"></span> View Raw File</a></td>
            <td></td>
          </tr>
          <tr>
            <td colspan="5"><a href="https://searchcode.com/codesearch/view/28602337/#" rel="nofollow" id="view-similar-link" class="hidden">
              <span class="glyphicon glyphicon-retweet"></span> <span id="similar-files" data-id="28602337">Find Similar Files</span></a> 
              <a href="https://searchcode.com/codesearch/view/28602337/#" rel="nofollow" id="file-tree-link" class="">
                  <span class="glyphicon glyphicon-tree-conifer"></span> <span id="file-tree-button" data-id="129872">View File Tree</span>
              </a>
              
              
            </td>
          </tr>
          <tr id="related-results">
            <td id="related-results-list" colspan="4"><h5>Matching Results</h5><ul class="list-unstyled"><li><a href="https://searchcode.com/codesearch/view/28602337/">Daylight.cs in weatherspark</a> /WeatherSpark.Data</li></ul></td>
          </tr>
        </tbody>
    </table>

    <div class="row">
      <div class="col-md-4" id="file-tree">
        <div id="file-tree-list">
        </div>
      </div>
      <div class="col-md-8">
        <table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="l-1"></a>using System;
<a name="l-2"></a>
<a name="l-3"></a>namespace EmperialApps.WeatherSpark.Data {
<a name="l-4"></a>
<a name="l-5"></a>    /// <span class="nt">&lt;summary&gt;</span>Implementation of the sunrise equation.<span class="nt">&lt;/summary&gt;</span>
<a name="l-6"></a>    /// <span class="nt">&lt;see</span> <span class="na">href=</span><span class="s">"http://en.wikipedia.org/wiki/Sunrise_equation"</span><span class="nt">/&gt;</span>
<a name="l-7"></a>    /// <span class="nt">&lt;see</span> <span class="na">href=</span><span class="s">"http://www.esrl.noaa.gov/gmd/grad/solcalc/sunrise.html"</span><span class="nt">/&gt;</span>
<a name="l-8"></a>    public static class Daylight {
<a name="l-9"></a>
<a name="l-10"></a>        /// <span class="nt">&lt;summary&gt;</span>Gets the Julian date for the specified local date.<span class="nt">&lt;/summary&gt;</span>
<a name="l-11"></a>        public static double GetJulianDate( DateTimeOffset date ) {
<a name="l-12"></a>            DateTimeOffset offsetDate = date.AddDays( GregorianJulianOffset )
<a name="l-13"></a>                .ToUniversalTime( );
<a name="l-14"></a>            TimeSpan startDifference = offsetDate - JulianStart;
<a name="l-15"></a>            return startDifference.TotalDays;
<a name="l-16"></a>        }
<a name="l-17"></a>
<a name="l-18"></a>        /// <span class="nt">&lt;summary&gt;</span>Gets the time of sunrise and sunset for the specified date.<span class="nt">&lt;/summary&gt;</span>
<a name="l-19"></a>        public static Pair<span class="nt">&lt;DateTimeOffset</span><span class="err">,</span> <span class="err">DateTimeOffset</span><span class="nt">&gt;</span> Calculate( Coordinate location, DateTimeOffset date ) {
<a name="l-20"></a>            double latitude = location.Latitude;
<a name="l-21"></a>            double longitude = location.Longitude;
<a name="l-22"></a>            double timezoneOffset = date.Offset.TotalHours;
<a name="l-23"></a>
<a name="l-24"></a>            double julianDay = GetJulianDate( date ) + 0.5;
<a name="l-25"></a>            double julianCentury = (julianDay - 2451545) / 36525;
<a name="l-26"></a>
<a name="l-27"></a>            double solarMeanLongitude = (280.46646 + julianCentury * (36000.76983 + julianCentury * 0.0003032)) % FullDegrees;
<a name="l-28"></a>            double solarMeanAnomoly = 357.52911 + julianCentury * (35999.05029 - 0.0001537 * julianCentury);
<a name="l-29"></a>            double earthOrbitEccentricity = 0.016708634 - julianCentury * (0.000042037 + 0.0000001267 * julianCentury);
<a name="l-30"></a>            double solarEquationOfCenter =
<a name="l-31"></a>                      Sine( solarMeanAnomoly ) * (1.914602 - julianCentury * (0.004817 + 0.000014 * julianCentury))
<a name="l-32"></a>                + Sine( 2 * solarMeanAnomoly ) * (0.019993 - 0.000101 * julianCentury)
<a name="l-33"></a>                + Sine( 3 * solarMeanAnomoly ) * 0.000289;
<a name="l-34"></a>
<a name="l-35"></a>            double solarTrueLongitude = solarMeanLongitude + solarEquationOfCenter;
<a name="l-36"></a>            double solarApparentLongitude = solarTrueLongitude - 0.00569 - 0.00478 * Sine( 125.04 - 1934.136 * julianCentury );
<a name="l-37"></a>            double meanObliqueEcliptic = 23 + (26 + ((21.448 - julianCentury * (46.815 + julianCentury * (0.00059 - julianCentury * 0.001813)))) / 60) / 60;
<a name="l-38"></a>            double obliqueCorrection = meanObliqueEcliptic + 0.00256 * Cosine( 125.04 - 1934.136 * julianCentury );
<a name="l-39"></a>
<a name="l-40"></a>            double solarDeclination = ArcSine( Sine( obliqueCorrection ) * Sine( solarApparentLongitude ) );
<a name="l-41"></a>            double y = Math.Pow( Tangent( obliqueCorrection / 2 ), 2 );
<a name="l-42"></a>            double equationOfTime =
<a name="l-43"></a>                  4 * RadiansToDegrees( y * Sine( 2 * solarMeanLongitude )
<a name="l-44"></a>                - 2 * earthOrbitEccentricity * Sine( solarMeanAnomoly )
<a name="l-45"></a>                + 4 * earthOrbitEccentricity * Sine( solarMeanAnomoly ) * y * Cosine( 2 * solarMeanLongitude )
<a name="l-46"></a>                - 0.5 * y * y * Sine( 4 * solarMeanLongitude )
<a name="l-47"></a>                - 1.25 * earthOrbitEccentricity * earthOrbitEccentricity * Sine( 2 * solarMeanAnomoly ) );
<a name="l-48"></a>            double sunriseHourAngle = ArcCosine( Cosine( 90.833 ) / (Cosine( latitude ) * Cosine( solarDeclination )) - Tangent( latitude ) * Tangent( solarDeclination ) );
<a name="l-49"></a>
<a name="l-50"></a>            double solarNoon = (720 - 4 * longitude - equationOfTime + timezoneOffset * 60) / MinutesPerDay;
<a name="l-51"></a>            double sunrise = (solarNoon * MinutesPerDay - sunriseHourAngle * 4) / MinutesPerDay;
<a name="l-52"></a>            double sunset = (solarNoon * MinutesPerDay + sunriseHourAngle * 4) / MinutesPerDay;
<a name="l-53"></a>
<a name="l-54"></a>            var daylight = Pair.Create(
<a name="l-55"></a>                date.AddDays( sunrise ),
<a name="l-56"></a>                date.AddDays( sunset ) );
<a name="l-57"></a>            return daylight;
<a name="l-58"></a>        }
<a name="l-59"></a>
<a name="l-60"></a>
<a name="l-61"></a>        #region Private Members
<a name="l-62"></a>
<a name="l-63"></a>        private const double FullDegrees = 360;
<a name="l-64"></a>        private const double HalfDegrees = FullDegrees / 2;
<a name="l-65"></a>
<a name="l-66"></a>        private const double MinutesPerDay = 1440;
<a name="l-67"></a>        private const double GregorianJulianOffset = 2415018.5;
<a name="l-68"></a>        private static readonly DateTimeOffset JulianStart = new DateTimeOffset( ).AddDays( 693593 );
<a name="l-69"></a>
<a name="l-70"></a>
<a name="l-71"></a>        private static double Sine( double degrees ) {
<a name="l-72"></a>            double radians = DegreesToRadians( degrees );
<a name="l-73"></a>            return Math.Sin( radians );
<a name="l-74"></a>        }
<a name="l-75"></a>
<a name="l-76"></a>        private static double Cosine( double degrees ) {
<a name="l-77"></a>            double radians = DegreesToRadians( degrees );
<a name="l-78"></a>            return Math.Cos( radians );
<a name="l-79"></a>        }
<a name="l-80"></a>
<a name="l-81"></a>        private static double Tangent( double degrees ) {
<a name="l-82"></a>            double radians = DegreesToRadians( degrees );
<a name="l-83"></a>            return Math.Tan( radians );
<a name="l-84"></a>        }
<a name="l-85"></a>
<a name="l-86"></a>        private static double ArcSine( double sine ) {
<a name="l-87"></a>            double radians = Math.Asin( sine );
<a name="l-88"></a>            return RadiansToDegrees( radians );
<a name="l-89"></a>        }
<a name="l-90"></a>
<a name="l-91"></a>        private static double ArcCosine( double cosine ) {
<a name="l-92"></a>            double radians = Math.Acos( cosine );
<a name="l-93"></a>            return RadiansToDegrees( radians );
<a name="l-94"></a>        }
<a name="l-95"></a>
<a name="l-96"></a>
<a name="l-97"></a>        private static double DegreesToRadians( double degrees ) {
<a name="l-98"></a>            double radians = Math.PI * degrees / HalfDegrees;
<a name="l-99"></a>            return radians;
<a name="l-100"></a>        }
<a name="l-101"></a>
<a name="l-102"></a>        private static double RadiansToDegrees( double radians ) {
<a name="l-103"></a>            double degrees = HalfDegrees * radians / Math.PI;
<a name="l-104"></a>            return degrees;
<a name="l-105"></a>        }
<a name="l-106"></a>
<a name="l-107"></a>        #endregion
<a name="l-108"></a>    }
<a name="l-109"></a>
<a name="l-110"></a>}
</pre></div>
</td></tr></tbody></table>
      </div>
    </div>
    <a href="https://searchcode.com/codesearch/view/28602337/#" class="back-to-top" style="display: inline;">Back to Top</a>
  
<div class="footer">
  <p>
    </p><ul>
      <li><a href="https://searchcode.com/about/">About</a></li>
      <li><a href="https://searchcode.com/api/">Developers</a></li>
      <li><a href="http://www.boyter.org/category/searchcode/">Updates</a></li>
      <li><a href="https://searchcode.com/spdx/">SPDX Search</a></li>
      <li><a href="https://searchcode.com/product/">searchcode server</a></li>
    </ul>
  <p></p>
  <p>
  </p>

<p>
  <!-- Begin MailChimp Signup Form -->
  Subscribe to the searchcode newsletter
</p><div id="mc_embed_signup">
<form action="https://searchcode.us13.list-manage.com/subscribe/post?u=bfcb89abd82d48825bbd1270f&amp;id=450cd94d81" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
    <div id="mc_embed_signup_scroll">
<div class="mc-field-group">
  <input type="email" value="" placeholder="Your email..." name="EMAIL" class="required email" id="mce-EMAIL">
  <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button btn btn-xs btn-primary">
</div>
  <div id="mce-responses" class="clear">
    <div class="response" id="mce-error-response" style="display:none"></div>
    <div class="response" id="mce-success-response" style="display:none"></div>
  </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_bfcb89abd82d48825bbd1270f_450cd94d81" tabindex="-1" value=""></div>
    </div>
</form>
</div>
<!--End mc_embed_signup-->
<p></p>


  <p>searchcode is proudly Made in Sydney | Â© searchcode 2016</p>
  <script async="" src="./Daylight.cs in weatherspark _ source code search engine_files/script.js.download"></script>
  <script async="" src="./Daylight.cs in weatherspark _ source code search engine_files/jquery.nouislider.min.js.download"></script>
  <script async="" src="./Daylight.cs in weatherspark _ source code search engine_files/bootstrap.min.js.download"></script>
  <script async="" src="./Daylight.cs in weatherspark _ source code search engine_files/typeahead.bundle.min.js.download"></script>
</div>
</div> 

<script>
(function() {
var dc = document.createElement('script');
dc.type = 'text/javascript'; dc.async = true;
dc.src = '//portfold.com/code/1/';
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(dc, s);
})();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-23451493-1', 'auto');
  ga('send', 'pageview');

</script>

</div></body></html>